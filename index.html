<!DOCTYPE html>
<html>
<head>
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
  <link
    rel="stylesheet"
    as="style"
    onload="this.rel='stylesheet'"
    href="https://fonts.googleapis.com/css2?display=swap&amp;family=Manrope%3Awght%40400%3B500%3B700%3B800&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900"
  />

  <title id="page-title">Mindful Touch</title>
  <link rel="icon" type="image/x-icon" href="favicon.ico" />
  <link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />

  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <script src="config.js"></script>
  <script src="js/components.js"></script>
  <script src="js/router.js"></script>
  <script src="js/pages.js"></script>
</head>
<body>
  <div class="relative flex size-full min-h-screen flex-col" id="main-container" style='font-family: Manrope, "Noto Sans", sans-serif;'>
    <div class="layout-container flex h-full grow flex-col">
      <div id="header-container"></div>
      <div id="page-content"></div>
      <div id="footer-container"></div>
    </div>
  </div>
  
  <script>
    // Apply configuration on page load
    document.addEventListener('DOMContentLoaded', function() {
      if (typeof config !== 'undefined') {
        initializeApp();
      }
    });

    function initializeApp() {
      // Update page title
      document.getElementById('page-title').textContent = config.appName;
      
      // Render layout components
      document.getElementById('header-container').innerHTML = Components.header();
      document.getElementById('footer-container').innerHTML = Components.footer();
      
      // Apply colors to the main container
      applyColors();
      
      // Setup navigation
      setupNavigation();
    }

    function setupNavigation() {
      // Add click handlers for navigation
      const navLinks = document.querySelectorAll('.nav-link');
      navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          const href = this.getAttribute('href');
          
          // Handle anchor links vs page routes
          if (href.startsWith('#')) {
            // Scroll to section on home page
            if (window.location.pathname !== '/') {
              router.navigate('/');
              setTimeout(() => {
                document.querySelector(href)?.scrollIntoView({behavior: 'smooth'});
              }, 100);
            } else {
              document.querySelector(href)?.scrollIntoView({behavior: 'smooth'});
            }
          } else {
            router.navigate(href);
          }
        });
      });
    }

    function applyColors() {
      const mainContainer = document.getElementById('main-container');
      const header = document.querySelector('#header-container header');
      
      // Set main background
      mainContainer.style.backgroundColor = config.backgroundColor;
      
      // Set header border and colors
      if (header) {
        header.style.borderColor = config.borderColor;
        header.style.color = config.textColor;
      }
      
      // Apply colors to navigation
      const navLinks = document.querySelectorAll('.nav-link');
      navLinks.forEach(link => {
        link.style.color = config.textColor;
      });
      
      // Apply colors to buttons
      const buttons = document.querySelectorAll('button');
      buttons.forEach(button => {
        if (button.id === 'download-btn' || button.id === 'hero-download-btn' || button.classList.contains('download-btn')) {
          button.style.backgroundColor = config.primaryColor;
          button.style.color = config.textColor;
        } else if (button.id === 'github-btn' || button.id === 'facebook-btn' || button.classList.contains('source-btn') || button.classList.contains('github-help-btn')) {
          button.style.backgroundColor = config.secondaryColor;
          button.style.color = config.textColor;
        }
      });
      
      // Apply colors to cards and other elements
      const cards = document.querySelectorAll('.feature-card, .download-card');
      cards.forEach(card => {
        card.style.borderColor = config.borderColor;
        card.style.backgroundColor = config.backgroundColor;
      });
      
      // Apply text colors
      const titles = document.querySelectorAll('.feature-title, h1, h2, h3, h4');
      titles.forEach(title => {
        title.style.color = config.textColor;
      });
      
      const descriptions = document.querySelectorAll('.feature-description, p');
      descriptions.forEach(desc => {
        desc.style.color = config.textColor;
      });
      
      const mutedText = document.querySelectorAll('#copyright, .text-gray-600');
      mutedText.forEach(text => {
        text.style.color = config.mutedTextColor;
      });
    }

    function applyBackgroundImages() {
      const heroSection = document.getElementById('hero-section');
      if (heroSection) {
        heroSection.style.backgroundImage = `${config.heroOverlayGradient}, url("${config.heroBackgroundImage}")`;
      }
    }

    function updateLinks() {
      // Update download buttons
      const downloadBtns = document.querySelectorAll('#download-btn, #hero-download-btn, .download-btn');
      downloadBtns.forEach(btn => {
        btn.onclick = () => window.open(config.downloadUrl, '_blank');
      });
      
      // Update GitHub buttons
      const githubBtns = document.querySelectorAll('#github-btn, .source-btn');
      githubBtns.forEach(btn => {
        btn.onclick = () => window.open(config.githubUrl, '_blank');
      });
      
      // Update Facebook button
      const facebookBtn = document.getElementById('facebook-btn');
      if (facebookBtn) {
        facebookBtn.onclick = () => window.open(config.facebookUrl, '_blank');
      }
    }

    // Global functions for pages to use
    window.applyColors = applyColors;
    window.applyBackgroundImages = applyBackgroundImages;
    window.updateLinks = updateLinks;
  </script>
</body>
</html>